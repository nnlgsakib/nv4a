{"ast":null,"code":"import _createForOfIteratorHelper from\"/root/experiment/nova-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import queryString from\"query-string\";function preserveQueryParameters(history,preserve,location){var currentQuery=queryString.parse(window.location.search);if(currentQuery){var preservedQuery={};var _iterator=_createForOfIteratorHelper(preserve),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var p=_step.value;var v=currentQuery[p];if(v){preservedQuery[p]=v;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(location.search){Object.assign(preservedQuery,queryString.parse(location.search));}location.search=queryString.stringify(preservedQuery);}return location;}function createLocationDescriptorObject(location,state){return typeof location===\"string\"?{pathname:location,state:state}:location;}export function createPreserveQueryHistory(createHistory,queryParameters){return function(options){var history=createHistory(options);var oldPush=history.push;var oldReplace=history.replace;history.push=function(path,state){return oldPush.apply(history,[preserveQueryParameters(history,queryParameters,createLocationDescriptorObject(path,state))]);};history.replace=function(path,state){return oldReplace.apply(history,[preserveQueryParameters(history,queryParameters,createLocationDescriptorObject(path,state))]);};return history;};}","map":{"version":3,"names":["queryString","preserveQueryParameters","history","preserve","location","currentQuery","parse","window","search","preservedQuery","_iterator","_createForOfIteratorHelper","_step","s","n","done","p","value","v","err","e","f","Object","assign","stringify","createLocationDescriptorObject","state","pathname","createPreserveQueryHistory","createHistory","queryParameters","options","oldPush","push","oldReplace","replace","path","apply"],"sources":["/root/experiment/nova-explorer/src/helpers/createPreserveHistory.ts"],"sourcesContent":["import { History, LocationDescriptor, LocationDescriptorObject } from \"history\";\nimport queryString from \"query-string\";\n\ntype LocationState = History.LocationState;\n\ntype CreateHistory<O, H> = (options?: O) => History & H;\n\nfunction preserveQueryParameters(\n  history: History,\n  preserve: string[],\n  location: LocationDescriptorObject,\n): LocationDescriptorObject {\n  const currentQuery = queryString.parse(window.location.search);\n  if (currentQuery) {\n    const preservedQuery: { [key: string]: any } = {};\n    for (const p of preserve) {\n      const v = currentQuery[p];\n      if (v) {\n        preservedQuery[p] = v;\n      }\n    }\n    if (location.search) {\n      Object.assign(preservedQuery, queryString.parse(location.search));\n    }\n    location.search = queryString.stringify(preservedQuery);\n  }\n  return location;\n}\n\nfunction createLocationDescriptorObject(location: LocationDescriptor, state?: LocationState): LocationDescriptorObject {\n  return typeof location === \"string\" ? { pathname: location, state } : location;\n}\n\nexport function createPreserveQueryHistory<O, H>(\n  createHistory: CreateHistory<O, H>,\n  queryParameters: string[],\n): CreateHistory<O, H> {\n  return (options?: O) => {\n    const history = createHistory(options);\n    const oldPush = history.push;\n    const oldReplace = history.replace;\n    history.push = (path: LocationDescriptor, state?: LocationState) =>\n      oldPush.apply(history, [\n        preserveQueryParameters(history, queryParameters, createLocationDescriptorObject(path, state)),\n      ]);\n    history.replace = (path: LocationDescriptor, state?: LocationState) =>\n      oldReplace.apply(history, [\n        preserveQueryParameters(history, queryParameters, createLocationDescriptorObject(path, state)),\n      ]);\n    return history;\n  };\n}\n"],"mappings":"6KACA,MAAO,CAAAA,WAAW,KAAM,cAAc,CAMtC,QAAS,CAAAC,uBAAuBA,CAC9BC,OAAgB,CAChBC,QAAkB,CAClBC,QAAkC,CACR,CAC1B,GAAM,CAAAC,YAAY,CAAGL,WAAW,CAACM,KAAK,CAACC,MAAM,CAACH,QAAQ,CAACI,MAAM,CAAC,CAC9D,GAAIH,YAAY,CAAE,CAChB,GAAM,CAAAI,cAAsC,CAAG,CAAC,CAAC,CAAC,IAAAC,SAAA,CAAAC,0BAAA,CAClCR,QAAQ,EAAAS,KAAA,KAAxB,IAAAF,SAAA,CAAAG,CAAA,KAAAD,KAAA,CAAAF,SAAA,CAAAI,CAAA,IAAAC,IAAA,EAA0B,IAAf,CAAAC,CAAC,CAAAJ,KAAA,CAAAK,KAAA,CACV,GAAM,CAAAC,CAAC,CAAGb,YAAY,CAACW,CAAC,CAAC,CACzB,GAAIE,CAAC,CAAE,CACLT,cAAc,CAACO,CAAC,CAAC,CAAGE,CAAC,CACvB,CACF,CAAC,OAAAC,GAAA,EAAAT,SAAA,CAAAU,CAAA,CAAAD,GAAA,WAAAT,SAAA,CAAAW,CAAA,IACD,GAAIjB,QAAQ,CAACI,MAAM,CAAE,CACnBc,MAAM,CAACC,MAAM,CAACd,cAAc,CAAET,WAAW,CAACM,KAAK,CAACF,QAAQ,CAACI,MAAM,CAAC,CAAC,CACnE,CACAJ,QAAQ,CAACI,MAAM,CAAGR,WAAW,CAACwB,SAAS,CAACf,cAAc,CAAC,CACzD,CACA,MAAO,CAAAL,QAAQ,CACjB,CAEA,QAAS,CAAAqB,8BAA8BA,CAACrB,QAA4B,CAAEsB,KAAqB,CAA4B,CACrH,MAAO,OAAO,CAAAtB,QAAQ,GAAK,QAAQ,CAAG,CAAEuB,QAAQ,CAAEvB,QAAQ,CAAEsB,KAAK,CAALA,KAAM,CAAC,CAAGtB,QAAQ,CAChF,CAEA,MAAO,SAAS,CAAAwB,0BAA0BA,CACxCC,aAAkC,CAClCC,eAAyB,CACJ,CACrB,MAAO,UAACC,OAAW,CAAK,CACtB,GAAM,CAAA7B,OAAO,CAAG2B,aAAa,CAACE,OAAO,CAAC,CACtC,GAAM,CAAAC,OAAO,CAAG9B,OAAO,CAAC+B,IAAI,CAC5B,GAAM,CAAAC,UAAU,CAAGhC,OAAO,CAACiC,OAAO,CAClCjC,OAAO,CAAC+B,IAAI,CAAG,SAACG,IAAwB,CAAEV,KAAqB,QAC7D,CAAAM,OAAO,CAACK,KAAK,CAACnC,OAAO,CAAE,CACrBD,uBAAuB,CAACC,OAAO,CAAE4B,eAAe,CAAEL,8BAA8B,CAACW,IAAI,CAAEV,KAAK,CAAC,CAAC,CAC/F,CAAC,GACJxB,OAAO,CAACiC,OAAO,CAAG,SAACC,IAAwB,CAAEV,KAAqB,QAChE,CAAAQ,UAAU,CAACG,KAAK,CAACnC,OAAO,CAAE,CACxBD,uBAAuB,CAACC,OAAO,CAAE4B,eAAe,CAAEL,8BAA8B,CAACW,IAAI,CAAEV,KAAK,CAAC,CAAC,CAC/F,CAAC,GACJ,MAAO,CAAAxB,OAAO,CAChB,CAAC,CACH"},"metadata":{},"sourceType":"module"}